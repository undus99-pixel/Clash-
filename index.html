<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Liga Clash Montoro - Clasificación</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background:#f5f7fa; }
    h1 { text-align:center; }
    table { border-collapse: collapse; width: 100%; background:white; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; font-size: 14px; }
    th { background-color: #2c3e50; color:white; }
    tr:nth-child(even) { background-color: #f2f2f2; }
    .top { background-color:#d4edda !important; }
  </style>
</head>
<body>

<h1>Buló D'Or Clash – Tabla de Clasificación</h1>
<table id="tabla"></table>

<script>
async function cargarExcel() {
  const response = await fetch('clasificacion.xlsx');
  const data = await response.arrayBuffer();
  const workbook = XLSX.read(data, { type: 'array' });
  const sheet = workbook.Sheets[workbook.SheetNames[0]];
  const filas = XLSX.utils.sheet_to_json(sheet, { header: 1 });

  if (filas.length < 2) return;

  const encabezados = filas[0];
  let datos = filas.slice(1);

  const idxPTS = encabezados.indexOf('PTS');

  // Ordenar por PTS (descendente)
  if (idxPTS !== -1) {
    datos.sort((a, b) => (b[idxPTS] || 0) - (a[idxPTS] || 0));
  }

  const tabla = document.getElementById('tabla');
  tabla.innerHTML = '';

  // Cabecera
  const trHead = document.createElement('tr');
  encabezados.forEach(h => {
    const th = document.createElement('th');
    th.textContent = h;
    trHead.appendChild(th);
  });
  tabla.appendChild(trHead);

  // Filas
  datos.forEach((fila, i) => {
    const tr = document.createElement('tr');

    fila.forEach((celda, j) => {
      const td = document.createElement('td');
      if (j === 0) {
        td.textContent = i + 1; // POSICIÓN AUTOMÁTICA
      } else {
        td.textContent = celda ?? '';
      }
      tr.appendChild(td);
    });

    if (i < 3) tr.classList.add('top'); // Top 3
    tabla.appendChild(tr);
  });
}

cargarExcel();
setInterval(cargarExcel, 30000);
</script>

</body>
</html>
